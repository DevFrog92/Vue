{"version":3,"sources":["webpack:///./src/assets/js/script.js","webpack:///src/view/RoomView.vue","webpack:///./src/view/RoomView.vue?74d8","webpack:///./src/view/RoomView.vue"],"names":["init","console","log","socket","io","videoGrid","document","querySelector","myVideo","createElement","peers","myPeer","Peer","port","config","iceServers","url","credential","username","muted","getUserMedia","navigator","webkitGetUserMedia","mozGetUserMedia","mediaDevices","video","audio","then","stream","addVideoStream","on","call","answer","userVideoStream","userId","remoteStream","remove","connectToNewUser","close","srcObject","addEventListener","play","append","id","emit","RoomView","name","data","created","this","$route","params","roomId","mounted","methods","exitRoom","window","open","view_RoomView","render","_h","$createElement","_c","_self","click","_v","attrs","staticRenderFns","Component","__webpack_require__","normalizeComponent","__webpack_exports__"],"mappings":"qGAAO,IAAMA,EAAO,WAClBC,QAAQC,IAAI,uBAEZ,IAAMC,EAASC,GAAG,KACZC,EAAYC,SAASC,cAAc,eACnCC,EAAUF,SAASG,cAAc,SACnCC,KASAC,EAAS,IAAIC,MACfC,KAAM,IACNC,QACEC,aAEIC,IAAK,wBACLC,WAAY,SACZC,SAAU,oBAGVF,IAAK,wCACLC,WAAY,+BACZC,SAAU,wBAGVF,IAAK,wCACLC,WAAY,+BACZC,SAAU,wBAGVF,IAAK,0BACLC,WAAY,QACZC,SAAU,UAGVF,IAAK,8CACLC,WAAY,SACZC,SAAU,WAGVF,KAAM,wCACNC,WAAY,uBACZC,SAAU,4BAMlBV,EAAQW,OAAQ,EAEhB,IAAIC,EACFC,UAAUD,cACVC,UAAUC,oBACVD,UAAUE,gBAEZF,UAAUG,aACPJ,cACCK,OAAO,EACPC,OAAO,IAERC,KAAK,SAAAC,GAEJC,EAAerB,EAASoB,GAExBjB,EAAOmB,GAAG,OAAQ,SAAAC,GAChB9B,QAAQC,IAAI,WACZ6B,EAAKC,OAAOJ,GACZ,IAAMH,EAAQnB,SAASG,cAAc,SAErCsB,EAAKD,GAAG,SAAU,SAAAG,GAChBJ,EAAeJ,EAAOQ,GACtBhC,QAAQC,IAAIQ,OAIhBP,EAAO2B,GAAG,iBAAkB,SAAAI,IAkChC,SAA0BA,EAAQN,GAChC,IAAMG,EAAOpB,EAAOoB,KAAKG,EAAQN,GACjC3B,QAAQC,IAAI,iBACZ,IAAMuB,EAAQnB,SAASG,cAAc,SAErCsB,EAAKD,GAAG,SAAU,SAAAK,GAChBN,EAAeJ,EAAOU,KAGxBJ,EAAKD,GAAG,QAAS,WACfL,EAAMW,WAGR1B,EAAMwB,GAAUH,EA9CZM,CAAiBH,EAAQN,KAE3BzB,EAAO2B,GAAG,oBAAqB,SAAAI,GACzBxB,EAAMwB,IAASxB,EAAMwB,GAAQI,YAIvC3B,EAAOmB,GAAG,OAAQ,SAASC,GACzBX,GAAeK,OAAO,EAAMC,OAAO,GAAQ,SAASE,GAClDG,EAAKC,OAAOJ,GACZ,IAAMH,EAAQnB,SAASG,cAAc,SACrCsB,EAAKD,GAAG,SAAU,SAASK,GACzBN,EAAeJ,EAAOU,SAqC5B,SAASN,EAAeJ,EAAOG,GAC7B3B,QAAQC,IAAI,oBACZuB,EAAMc,UAAYX,EAClBH,EAAMe,iBAAiB,iBAAkB,WACvCf,EAAMgB,SAERxC,QAAQC,IAAI,kBACZG,EAAUqC,OAAOjB,GAtCnBd,EAAOmB,GAAG,OAAQ,SAAAa,GAChBxC,EAAOyC,KAAK,YAHE,gBAGoBD,KAGpCxC,EAAO2B,GAAG,iBAAkB,SAAAI,GAC1BjC,QAAQC,IAAI,kBAAoBgC,KAGlC/B,EAAO2B,GAAG,oBAAqB,SAAAI,GACzBxB,EAAMwB,KACRjC,QAAQC,IAAI,gBACZQ,EAAMwB,GAAQI,YCrGpBO,GACAC,KAAA,OACAC,KAFA,WAGA,UAEAC,QALA,WAMA/C,QAAAC,IAAA+C,KAAAC,OAAAC,OAAAC,SAEAC,QARA,WASIrD,KAEJsD,SACAC,SADA,WAEAC,OAAAC,KAAA,YAAAnB,WCnBeoB,GADEC,OAFjB,WAA0B,IAAaC,EAAbX,KAAaY,eAA0BC,EAAvCb,KAAuCc,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAAA,EAAA,OAA2BhC,IAAIkC,MAA9Ff,KAA8FM,YAA9FN,KAAoHgB,GAAA,WAApHhB,KAAoHgB,GAAA,KAAAH,EAAA,OAA0CI,OAAOvB,GAAA,mBAE9KwB,oBCYjBC,EAdyBC,EAAQ,OAcjCC,CACEzB,EACAa,GATF,EAEA,KAEA,KAEA,MAUea,EAAA,QAAAH,EAAiB","file":"static/js/1.e39787bc63acba6c47d1.js","sourcesContent":["export const init = () => {\r\n  console.log(\"this is script file\");\r\n\r\n  const socket = io(\"/\");\r\n  const videoGrid = document.querySelector(\"#video-grid\");\r\n  const myVideo = document.createElement(\"video\");\r\n  let peers = {};\r\n\r\n  // const myPeer = new Peer(undefined, {\r\n  //   host: \"/\",\r\n  //   port: \"3001\",\r\n  // });\r\n\r\n  // peerjs config\r\n\r\n  var myPeer = new Peer({\r\n    port: 443,\r\n    config: {\r\n      iceServers: [\r\n        {\r\n          url: \"turn:numb.viagenie.ca\",\r\n          credential: \"muazkh\",\r\n          username: \"webrtc@live.com\"\r\n        },\r\n        {\r\n          url: \"turn:192.158.29.39:3478?transport=udp\",\r\n          credential: \"JZEOEt2V3Qb0y27GRntt2u2PAYA=\",\r\n          username: \"28224511:1379330808\"\r\n        },\r\n        {\r\n          url: \"turn:192.158.29.39:3478?transport=tcp\",\r\n          credential: \"JZEOEt2V3Qb0y27GRntt2u2PAYA=\",\r\n          username: \"28224511:1379330808\"\r\n        },\r\n        {\r\n          url: \"turn:turn.bistri.com:80\",\r\n          credential: \"homeo\",\r\n          username: \"homeo\"\r\n        },\r\n        {\r\n          url: \"turn:turn.anyfirewall.com:433?transport=tcp\",\r\n          credential: \"webrtc\",\r\n          username: \"webrtc\"\r\n        },\r\n        {\r\n          url: [\"turn:13.250.13.83:3478?transport=tcp\"],\r\n          credential: \"YzYNCouZM1mhqhmseWk6\",\r\n          username: \"YzYNCouZM1mhqhmseWk6\"\r\n        }\r\n      ]\r\n    }\r\n  });\r\n\r\n  myVideo.muted = true;\r\n\r\n  var getUserMedia =\r\n    navigator.getUserMedia ||\r\n    navigator.webkitGetUserMedia ||\r\n    navigator.mozGetUserMedia;\r\n\r\n  navigator.mediaDevices\r\n    .getUserMedia({\r\n      video: true,\r\n      audio: true\r\n    })\r\n    .then(stream => {\r\n      // my video\r\n      addVideoStream(myVideo, stream);\r\n\r\n      myPeer.on(\"call\", call => {\r\n        console.log(\"calling\");\r\n        call.answer(stream);\r\n        const video = document.createElement(\"video\");\r\n\r\n        call.on(\"stream\", userVideoStream => {\r\n          addVideoStream(video, userVideoStream);\r\n          console.log(peers);\r\n        });\r\n      });\r\n\r\n      socket.on(\"user-connected\", userId => {\r\n        connectToNewUser(userId, stream);\r\n      });\r\n      socket.on(\"user-disconnected\", userId => {\r\n        if (peers[userId]) peers[userId].close();\r\n      });\r\n    });\r\n\r\n  myPeer.on(\"call\", function(call) {\r\n    getUserMedia({ video: true, audio: true }, function(stream) {\r\n      call.answer(stream);\r\n      const video = document.createElement(\"video\");\r\n      call.on(\"stream\", function(remoteStream) {\r\n        addVideoStream(video, remoteStream);\r\n      });\r\n    });\r\n  });\r\n  const ROOM_ID = \"<%= roomId %>\";\r\n\r\n  myPeer.on(\"open\", id => {\r\n    socket.emit(\"join-room\", ROOM_ID, id);\r\n  });\r\n\r\n  socket.on(\"user-connected\", userId => {\r\n    console.log(\"User connectd :\" + userId);\r\n  });\r\n\r\n  socket.on(\"user-disconnected\", userId => {\r\n    if (peers[userId]) {\r\n      console.log(\"disconnetced\");\r\n      peers[userId].close();\r\n    }\r\n  });\r\n\r\n  function connectToNewUser(userId, stream) {\r\n    const call = myPeer.call(userId, stream);\r\n    console.log(\"this is call \");\r\n    const video = document.createElement(\"video\");\r\n\r\n    call.on(\"stream\", remoteStream => {\r\n      addVideoStream(video, remoteStream);\r\n    });\r\n\r\n    call.on(\"close\", () => {\r\n      video.remove();\r\n    });\r\n\r\n    peers[userId] = call;\r\n  }\r\n\r\n  function addVideoStream(video, stream) {\r\n    console.log(\"add video stream\");\r\n    video.srcObject = stream;\r\n    video.addEventListener(\"loadedmetadata\", () => {\r\n      video.play();\r\n    });\r\n    console.log(\"video attached\");\r\n    videoGrid.append(video);\r\n  }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/assets/js/script.js","<template>\r\n  <div>\r\n    <div @click=\"exitRoom\">close</div>\r\n    <div id=\"video-grid\"></div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { init } from \"@/assets/js/script.js\";\r\nexport default {\r\n  name: \"Room\",\r\n  data() {\r\n    return {};\r\n  },\r\n  created() {\r\n    console.log(this.$route.params.roomId);\r\n  },\r\n  mounted() {\r\n    init();\r\n  },\r\n  methods: {\r\n    exitRoom() {\r\n      window.open(\"\", \"_self\").close();\r\n    },\r\n  },\r\n};\r\n</script>\r\n\n\n\n// WEBPACK FOOTER //\n// src/view/RoomView.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{on:{\"click\":_vm.exitRoom}},[_vm._v(\"close\")]),_vm._v(\" \"),_c('div',{attrs:{\"id\":\"video-grid\"}})])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-17094100\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/view/RoomView.vue\n// module id = null\n// module chunks = ","var normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./RoomView.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./RoomView.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-17094100\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./RoomView.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = null\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/view/RoomView.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}